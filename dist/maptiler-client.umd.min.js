(function(p,S){typeof exports=="object"&&typeof module<"u"?S(exports):typeof define=="function"&&define.amd?define(["exports"],S):(p=typeof globalThis<"u"?globalThis:p||self,S(p.maptilerclient={}))})(this,function(p){"use strict";function S(){return typeof self<"u"?fetch.bind(self):typeof global<"u"&&global.fetch?global.fetch:null}class v{constructor(){this._apiKey="Not defined yet.",this._fetch=S()}set apiKey(n){this._apiKey=n}get apiKey(){return this._apiKey}set fetch(n){this._fetch=n}get fetch(){return this._fetch}}const d=new v,k={AUTO:"auto",ALBANIAN:"sq",ARABIC:"ar",ARMENIAN:"hy",AZERBAIJANI:"az",BELORUSSIAN:"be",BOSNIAN:"bs",BRETON:"br",BULGARIAN:"bg",CATALAN:"ca",CHINESE:"zh",CROATIAN:"hr",CZECH:"cs",DANISH:"da",DUTCH:"nl",ENGLISH:"en",ESPERANTO:"eo",ESTONIAN:"et",FINNISH:"fi",FRENCH:"fr",FRISIAN:"fy",GEORGIAN:"ka",GERMAN:"de",GREEK:"el",HEBREW:"he",HUNGARIAN:"hu",ICELANDIC:"is",IRISH:"ga",ITALIAN:"it",JAPANESE:"ja",KANNADA:"kn",KAZAKH:"kk",KOREAN:"ko",ROMAN_LATIN:"la",LATVIAN:"lv",LITHUANIAN:"lt",LUXEMBOURGISH:"lb",MACEDONIAN:"mk",MALTESE:"mt",NORWEGIAN:"no",POLISH:"pl",PORTUGUESE:"pt",ROMANIAN:"ro",ROMANSH:"rm",RUSSIAN:"ru",SCOTTISH_GAELIC:"gd",SERBIAN_CYRILLIC:"sr",SLOVAK:"sk",SLOVENE:"sl",SPANISH:"es",SWEDISH:"sv",THAI:"th",TURKISH:"tr",UKRAINIAN:"uk",WELSH:"cy"},K=new Set(Object.values(k));function L(){if(typeof navigator>"u")return Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0];const e=Array.from(new Set(navigator.languages.map(n=>n.split("-")[0]))).filter(n=>K.has(n));return e.length?e[0]:k.ENGLISH}var O=(e,n,t)=>new Promise((r,a)=>{var i=o=>{try{s(t.next(o))}catch(l){a(l)}},c=o=>{try{s(t.throw(o))}catch(l){a(l)}},s=o=>o.done?r(o.value):Promise.resolve(o.value).then(i,c);s((t=t.apply(e,n)).next())});function $(e){return O(this,arguments,function*(n,t={}){if(d.fetch===null)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");return d.fetch(n,t)})}const g={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(g);class I extends Error{constructor(n,t=""){super(`Call to enpoint ${n.url} failed with the status code ${n.status}. ${t}`),this.res=n}}var U=(e,n,t)=>new Promise((r,a)=>{var i=o=>{try{s(t.next(o))}catch(l){a(l)}},c=o=>{try{s(t.throw(o))}catch(l){a(l)}},s=o=>o.done?r(o.value):Promise.resolve(o.value).then(i,c);s((t=t.apply(e,n)).next())});const P={400:"Query too long / Invalid parameters",403:"Key is missing, invalid or restricted"};function T(e){return U(this,arguments,function*(n,t={}){const r=new URL(`geocoding/${encodeURIComponent(n)}.json`,g.maptilerApiURL);if(r.searchParams.set("key",d.apiKey),"bbox"in t&&r.searchParams.set("bbox",[t.bbox.southWest.lng,t.bbox.southWest.lat,t.bbox.northEast.lng,t.bbox.northEast.lat].join(",")),"proximity"in t&&r.searchParams.set("proximity",[t.proximity.lng,t.proximity.lat].join(",")),"language"in t){const c=(Array.isArray(t.language)?t.language:[t.language]).map(s=>s===k.AUTO?L():s).join(",");r.searchParams.set("language",c)}const a=r.toString(),i=yield $(a);if(!i.ok)throw new I(i,i.status in P?P[i.status]:"");return yield i.json()})}function H(e){return U(this,arguments,function*(n,t={}){const r=new URL(`geocoding/${n.lng},${n.lat}.json`,g.maptilerApiURL);if(r.searchParams.set("key",d.apiKey),"bbox"in t&&r.searchParams.set("bbox",[t.bbox.southWest.lng,t.bbox.southWest.lat,t.bbox.northEast.lng,t.bbox.northEast.lat].join(",")),"proximity"in t&&r.searchParams.set("proximity",[t.proximity.lng,t.proximity.lat].join(",")),"language"in t){const c=(Array.isArray(t.language)?t.language:[t.language]).map(s=>s===k.AUTO?L():s).join(",");r.searchParams.set("language",c)}const a=r.toString(),i=yield $(a);if(!i.ok)throw new I(i,i.status in P?P[i.status]:"");return yield i.json()})}const D={forward:T,reverse:H};var W=(e,n,t)=>new Promise((r,a)=>{var i=o=>{try{s(t.next(o))}catch(l){a(l)}},c=o=>{try{s(t.throw(o))}catch(l){a(l)}},s=o=>o.done?r(o.value):Promise.resolve(o.value).then(i,c);s((t=t.apply(e,n)).next())});const C={403:"Key is missing, invalid or restricted"};function _(){return W(this,null,function*(){const e=new URL("geolocation/ip.json",g.maptilerApiURL);e.searchParams.set("key",d.apiKey);const n=e.toString(),t=yield $(n);if(!t.ok)throw new I(t,t.status in C?C[t.status]:"");return yield t.json()})}const G={info:_};var x=(e,n,t)=>new Promise((r,a)=>{var i=o=>{try{s(t.next(o))}catch(l){a(l)}},c=o=>{try{s(t.throw(o))}catch(l){a(l)}},s=o=>o.done?r(o.value):Promise.resolve(o.value).then(i,c);s((t=t.apply(e,n)).next())});const N={403:"Key is missing, invalid or restricted"};function M(e){return x(this,arguments,function*(n,t={}){const r=new URL(`coordinates/search/${n}.json`,g.maptilerApiURL);r.searchParams.set("key",d.apiKey),"limit"in t&&r.searchParams.set("limit",t.limit.toString()),"transformations"in t&&r.searchParams.set("transformations",t.transformations.toString()),"exports"in t&&r.searchParams.set("exports",t.exports.toString());const a=r.toString(),i=yield $(a);if(!i.ok)throw new I(i,i.status in N?N[i.status]:"");return yield i.json()})}function B(e){return x(this,arguments,function*(n,t={}){const r=(Array.isArray(n)?n:[n]).map(s=>`${s.lng},${s.lat}`).join(";"),a=new URL(`coordinates/transform/${r}.json`,g.maptilerApiURL);a.searchParams.set("key",d.apiKey),"sourceCrs"in t&&a.searchParams.set("s_srs",t.sourceCrs.toString()),"targetCrs"in t&&a.searchParams.set("t_srs",t.targetCrs.toString()),"operations"in t&&a.searchParams.set("ops",(Array.isArray(t.operations)?t.operations:[t.operations]).join("|"));const i=a.toString(),c=yield $(i);if(!c.ok)throw new I(c,c.status in N?N[c.status]:"");return yield c.json()})}const F={search:M,transform:B};var z=(e,n,t)=>new Promise((r,a)=>{var i=o=>{try{s(t.next(o))}catch(l){a(l)}},c=o=>{try{s(t.throw(o))}catch(l){a(l)}},s=o=>o.done?r(o.value):Promise.resolve(o.value).then(i,c);s((t=t.apply(e,n)).next())});const j={403:"Key is missing, invalid or restricted"};function J(e){return z(this,null,function*(){const n=new URL(`data/${encodeURIComponent(e)}/features.json`,g.maptilerApiURL);n.searchParams.set("key",d.apiKey);const t=n.toString(),r=yield $(t);if(!r.ok)throw new I(r,r.status in j?j[r.status]:"");return yield r.json()})}const V={get:J};function Z(e,n,t){let r=n[0],a=n[1],i=t[0]-r,c=t[1]-a;if(i!==0||c!==0){const s=((e[0]-r)*i+(e[1]-a)*c)/(i*i+c*c);s>1?(r=t[0],a=t[1]):s>0&&(r+=i*s,a+=c*s)}return i=e[0]-r,c=e[1]-a,i*i+c*c}function R(e,n,t,r,a){let i=r,c;for(let s=n+1;s<t;s++){const o=Z(e[s],e[n],e[t]);o>i&&(c=s,i=o)}i>r&&(c-n>1&&R(e,n,c,r,a),a.push(e[c]),t-c>1&&R(e,c,t,r,a))}function q(e,n){const t=e.length-1,r=[e[0]];return R(e,0,t,n,r),r.push(e[t]),r}function Q(e,n){if(e.length<=2)return e;const t=n!==void 0?n*n:1;return q(e,t)}function b(e,n=!0){let t=`${e.lng},${e.lat}`;return e.color&&n&&(t+=`,${e.color}`),t}function w(e,n=3e3){let t=e.map(i=>i.join(",")).join("|"),r=5e-6;const a=1e-5;for(;t.length>n;)t=Q(e,r).map(i=>`${i[0]},${i[1]}`).join("|"),r+=a;return t}function X(e,n,t={}){var r,a,i,c,s;const o=(r=t.style)!=null?r:g.mapStyle,l=t.hiDPI?"@2x":"",y=(a=t.format)!=null?a:"png";let f=~~((i=t.width)!=null?i:1024),u=~~((c=t.height)!=null?c:1024);t.hiDPI&&(f=~~(f/2),u=~~(u/2));const h=new URL(`maps/${encodeURIComponent(o)}/static/${e.lng},${e.lat},${n}/${f}x${u}${l}.${y}`,g.maptilerApiURL);if("attribution"in t&&h.searchParams.set("attribution",t.attribution.toString()),"marker"in t){let m="";const A="markerIcon"in t;A&&(m+=`icon:${t.markerIcon}|`),A&&"markerAnchor"in t&&(m+=`anchor:${t.markerAnchor}|`),A&&t.hiDPI&&(m+="scale:2|");const E=Array.isArray(t.marker)?t.marker:[t.marker];m+=E.map(nt=>b(nt,!A)).join("|"),h.searchParams.set("markers",m)}if("path"in t){let m="";if(m+=`fill:${(s=t.pathFillColor)!=null?s:"none"}|`,"pathStrokeColor"in t&&(m+=`stroke:${t.pathStrokeColor}|`),"pathWidth"in t){const A=t.pathWidth/(t.hiDPI?2:1);m+=`width:${A.toString()}|`}m+=w(t.path),h.searchParams.set("path",m)}return h.searchParams.set("key",d.apiKey),h.toString()}function Y(e,n={}){var t,r,a,i,c;const s=(t=n.style)!=null?t:g.mapStyle,o=n.hiDPI?"@2x":"",l=(r=n.format)!=null?r:"png";let y=~~((a=n.width)!=null?a:1024),f=~~((i=n.height)!=null?i:1024);n.hiDPI&&(y=~~(y/2),f=~~(f/2));const u=new URL(`maps/${encodeURIComponent(s)}/static/${e.southWest.lng},${e.southWest.lat},${e.northEast.lng},${e.northEast.lat}/${y}x${f}${o}.${l}`,g.maptilerApiURL);if("attribution"in n&&u.searchParams.set("attribution",n.attribution.toString()),"padding"in n&&u.searchParams.set("padding",n.padding.toString()),"marker"in n){let h="";const m="markerIcon"in n;m&&(h+=`icon:${n.markerIcon}|`),m&&"markerAnchor"in n&&(h+=`anchor:${n.markerAnchor}|`),m&&n.hiDPI&&(h+="scale:2|");const A=Array.isArray(n.marker)?n.marker:[n.marker];h+=A.map(E=>b(E,!m)).join("|"),u.searchParams.set("markers",h)}if("path"in n){let h="";if(h+=`fill:${(c=n.pathFillColor)!=null?c:"none"}|`,"pathStrokeColor"in n&&(h+=`stroke:${n.pathStrokeColor}|`),"pathWidth"in n){const m=n.pathWidth/(n.hiDPI?2:1);h+=`width:${m.toString()}|`}h+=w(n.path),u.searchParams.set("path",h)}return u.searchParams.set("key",d.apiKey),u.toString()}function tt(e={}){var n,t,r,a,i;if(!("marker"in e)&&!("path"in e))throw new Error("Automatic static maps require markers and/or path to be created.");const c=(n=e.style)!=null?n:g.mapStyle,s=e.hiDPI?"@2x":"",o=(t=e.format)!=null?t:"png";let l=~~((r=e.width)!=null?r:1024),y=~~((a=e.height)!=null?a:1024);e.hiDPI&&(l=~~(l/2),y=~~(y/2));const f=new URL(`maps/${encodeURIComponent(c)}/static/auto/${l}x${y}${s}.${o}`,g.maptilerApiURL);if("attribution"in e&&f.searchParams.set("attribution",e.attribution.toString()),"padding"in e&&f.searchParams.set("padding",e.padding.toString()),"marker"in e){let u="";const h="markerIcon"in e;h&&(u+=`icon:${e.markerIcon}|`),h&&"markerAnchor"in e&&(u+=`anchor:${e.markerAnchor}|`),h&&e.hiDPI&&(u+="scale:2|");const m=Array.isArray(e.marker)?e.marker:[e.marker];u+=m.map(A=>b(A,!h)).join("|"),f.searchParams.set("markers",u)}if("path"in e){let u="";if(u+=`fill:${(i=e.pathFillColor)!=null?i:"none"}|`,"pathStrokeColor"in e&&(u+=`stroke:${e.pathStrokeColor}|`),"pathWidth"in e){const h=e.pathWidth/(e.hiDPI?2:1);u+=`width:${h.toString()}|`}u+=w(e.path),f.searchParams.set("path",u)}return f.searchParams.set("key",d.apiKey),f.toString()}const et={centered:X,bounded:Y,automatic:tt};p.ClientConfig=v,p.Language=k,p.ServiceError=I,p.config=d,p.coordinates=F,p.data=V,p.geocoding=D,p.geolocation=G,p.staticMaps=et,Object.defineProperty(p,"__esModule",{value:!0})});
