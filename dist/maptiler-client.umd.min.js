(function(u,U){typeof exports=="object"&&typeof module<"u"?U(exports):typeof define=="function"&&define.amd?define(["exports"],U):(u=typeof globalThis<"u"?globalThis:u||self,U(u.maptilerClient={}))})(this,function(u){"use strict";var U=Object.defineProperty,se=(t,e,n)=>e in t?U(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,G=(t,e,n)=>(se(t,typeof e!="symbol"?e+"":e,n),n);function ce(){return typeof self<"u"?fetch.bind(self):typeof global<"u"&&global.fetch?global.fetch:null}class F{constructor(){G(this,"_apiKey",""),G(this,"_fetch",ce())}set apiKey(e){this._apiKey=e}get apiKey(){return this._apiKey}set fetch(e){this._fetch=e}get fetch(){return this._fetch}}const v=new F,$={AUTO:"auto",ALBANIAN:"sq",ARABIC:"ar",ARMENIAN:"hy",AZERBAIJANI:"az",BELORUSSIAN:"be",BOSNIAN:"bs",BRETON:"br",BULGARIAN:"bg",CATALAN:"ca",CHINESE:"zh",CROATIAN:"hr",CZECH:"cs",DANISH:"da",DUTCH:"nl",ENGLISH:"en",ESPERANTO:"eo",ESTONIAN:"et",FINNISH:"fi",FRENCH:"fr",FRISIAN:"fy",GEORGIAN:"ka",GERMAN:"de",GREEK:"el",HEBREW:"he",HUNGARIAN:"hu",ICELANDIC:"is",IRISH:"ga",ITALIAN:"it",JAPANESE:"ja",KANNADA:"kn",KAZAKH:"kk",KOREAN:"ko",ROMAN_LATIN:"la",LATVIAN:"lv",LITHUANIAN:"lt",LUXEMBOURGISH:"lb",MACEDONIAN:"mk",MALTESE:"mt",NORWEGIAN:"no",POLISH:"pl",PORTUGUESE:"pt",ROMANIAN:"ro",ROMANSH:"rm",RUSSIAN:"ru",SCOTTISH_GAELIC:"gd",SERBIAN_CYRILLIC:"sr",SLOVAK:"sk",SLOVENE:"sl",SPANISH:"es",SWEDISH:"sv",THAI:"th",TURKISH:"tr",UKRAINIAN:"uk",WELSH:"cy"},le=new Set(Object.values($));function ue(){if(typeof navigator>"u")return Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0];const t=Array.from(new Set(navigator.languages.map(e=>e.split("-")[0]))).filter(e=>le.has(e));return t.length?t[0]:$.ENGLISH}var me=(t,e,n)=>new Promise((i,r)=>{var o=s=>{try{c(n.next(s))}catch(l){r(l)}},a=s=>{try{c(n.throw(s))}catch(l){r(l)}},c=s=>s.done?i(s.value):Promise.resolve(s.value).then(o,a);c((n=n.apply(t,e)).next())});function S(t){return me(this,arguments,function*(e,n={}){if(v.fetch===null)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(new URL(e).searchParams.get("key").trim()==="")throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return v.fetch(e,n)})}const y={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(y);class A extends Error{constructor(e,n=""){super(`Call to enpoint ${e.url} failed with the status code ${e.status}. ${n}`),this.res=e}}var E=(t,e,n)=>new Promise((i,r)=>{var o=s=>{try{c(n.next(s))}catch(l){r(l)}},a=s=>{try{c(n.throw(s))}catch(l){r(l)}},c=s=>s.done?i(s.value):Promise.resolve(s.value).then(o,a);c((n=n.apply(t,e)).next())});const P={400:"Query too long / Invalid parameters",403:"Key is missing, invalid or restricted"};function z(t,e){if(e.language==null)return;const n=Array.from(new Set((Array.isArray(e.language)?e.language:[e.language]).map(i=>i===$.AUTO?ue():i))).join(",");t.set("language",n)}function x(t,e){var n;t.set("key",(n=e.apiKey)!=null?n:v.apiKey),e.limit!=null&&t.set("limit",String(e.limit)),e.types!=null&&t.set("types",e.types.join(",")),z(t,e)}function B(t,e){x(t,e),e.bbox!=null&&t.set("bbox",e.bbox.join(",")),e.proximity!=null&&t.set("proximity",e.proximity.join(",")),e.country!=null&&t.set("country",e.country.join(",")),e.fuzzyMatch!=null&&t.set("fuzzyMatch",e.fuzzyMatch?"true":"false"),e.autocomplete!=null&&t.set("autocomplete",e.autocomplete?"true":"false")}function pe(t){return E(this,arguments,function*(e,n={}){var i;if(typeof e!="string"||e.trim().length===0)throw new Error("The query must be a non-empty string");const r=new URL(`geocoding/${encodeURIComponent(e)}.json`,y.maptilerApiURL),{searchParams:o}=r;B(o,n);const a=r.toString(),c=yield S(a);if(!c.ok)throw new A(c,(i=P[c.status])!=null?i:"");return yield c.json()})}function de(t){return E(this,arguments,function*(e,n={}){var i;if(!Array.isArray(e)||e.length<2)throw new Error("The position must be an array of form [lng, lat].");const r=new URL(`geocoding/${e[0]},${e[1]}.json`,y.maptilerApiURL);x(r.searchParams,n);const o=r.toString(),a=yield S(o);if(!a.ok)throw new A(a,(i=P[a.status])!=null?i:"");return yield a.json()})}function he(t){return E(this,arguments,function*(e,n={}){var i;const r=new URL(`geocoding/${e}.json`,y.maptilerApiURL);z(r.searchParams,n);const o=r.toString(),a=yield S(o);if(!a.ok)throw new A(a,(i=P[a.status])!=null?i:"");return yield a.json()})}function fe(t){return E(this,arguments,function*(e,n={}){var i;if(!e.length)return[];const r=e.map(d=>encodeURIComponent(d)).join(";"),o=new URL(`geocoding/${r}.json`,y.maptilerApiURL),{searchParams:a}=o;B(a,n);const c=o.toString(),s=yield S(c);if(!s.ok)throw new A(s,(i=P[s.status])!=null?i:"");const l=yield s.json();return e.length===1?[l]:l})}const ge={forward:pe,reverse:de,byId:he,batch:fe,language:$};var ye=(t,e,n)=>new Promise((i,r)=>{var o=s=>{try{c(n.next(s))}catch(l){r(l)}},a=s=>{try{c(n.throw(s))}catch(l){r(l)}},c=s=>s.done?i(s.value):Promise.resolve(s.value).then(o,a);c((n=n.apply(t,e)).next())});const W={403:"Key is missing, invalid or restricted"};function ve(){return ye(this,arguments,function*(t={}){var e;const n=new URL("geolocation/ip.json",y.maptilerApiURL);n.searchParams.set("key",(e=t.apiKey)!=null?e:v.apiKey);const i=n.toString(),r=yield S(i);if(!r.ok)throw new A(r,r.status in W?W[r.status]:"");return yield r.json()})}const Ae={info:ve};var _=(t,e,n)=>new Promise((i,r)=>{var o=s=>{try{c(n.next(s))}catch(l){r(l)}},a=s=>{try{c(n.throw(s))}catch(l){r(l)}},c=s=>s.done?i(s.value):Promise.resolve(s.value).then(o,a);c((n=n.apply(t,e)).next())});const k={403:"Key is missing, invalid or restricted"};function Re(t){return _(this,arguments,function*(e,n={}){var i;if(typeof e!="string"||e.trim().length===0)throw new Error("The query must be a non-empty string");const r=new URL(`coordinates/search/${e}.json`,y.maptilerApiURL);r.searchParams.set("key",(i=n.apiKey)!=null?i:v.apiKey),"limit"in n&&r.searchParams.set("limit",n.limit.toString()),"transformations"in n&&r.searchParams.set("transformations",n.transformations.toString()),"exports"in n&&r.searchParams.set("exports",n.exports.toString());const o=r.toString(),a=yield S(o);if(!a.ok)throw new A(a,a.status in k?k[a.status]:"");return yield a.json()})}function Le(t){return _(this,arguments,function*(e,n={}){var i;const r=(Array.isArray(e[0])?e:[e]).map(s=>`${s[0]},${s[1]}`).join(";"),o=new URL(`coordinates/transform/${r}.json`,y.maptilerApiURL);o.searchParams.set("key",(i=n.apiKey)!=null?i:v.apiKey),"sourceCrs"in n&&o.searchParams.set("s_srs",n.sourceCrs.toString()),"targetCrs"in n&&o.searchParams.set("t_srs",n.targetCrs.toString()),"operations"in n&&o.searchParams.set("ops",(Array.isArray(n.operations)?n.operations:[n.operations]).join("|"));const a=o.toString(),c=yield S(a);if(!c.ok)throw new A(c,c.status in k?k[c.status]:"");return yield c.json()})}const Se={search:Re,transform:Le};var Ie=(t,e,n)=>new Promise((i,r)=>{var o=s=>{try{c(n.next(s))}catch(l){r(l)}},a=s=>{try{c(n.throw(s))}catch(l){r(l)}},c=s=>s.done?i(s.value):Promise.resolve(s.value).then(o,a);c((n=n.apply(t,e)).next())});const q={403:"Key is missing, invalid or restricted"};function Te(t){return Ie(this,arguments,function*(e,n={}){var i;if(typeof e!="string"||e.trim().length===0)throw new Error("The data ID must be a non-empty string");const r=new URL(`data/${encodeURIComponent(e)}/features.json`,y.maptilerApiURL);r.searchParams.set("key",(i=n.apiKey)!=null?i:v.apiKey);const o=r.toString(),a=yield S(o);if(!a.ok)throw new A(a,a.status in q?q[a.status]:"");return yield a.json()})}const Ue={get:Te};var $e=Object.defineProperty,De=(t,e,n)=>e in t?$e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Z=(t,e,n)=>(De(t,typeof e!="symbol"?e+"":e,n),n);function Y(t){const e=/^maptiler:\/\/(.*)/;let n;const i=t.trim();let r;return i.startsWith("http://")||i.startsWith("https://")?r=i:(n=e.exec(i))!==null?r=`https://api.maptiler.com/maps/${n[1]}/style.json`:r=`https://api.maptiler.com/maps/${i}/style.json`,r}class C{constructor(e,n,i,r,o,a){this.name=e,this.variantType=n,this.id=i,this.referenceStyle=r,this.description=o,this.imageURL=a}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(e){return this.referenceStyle.hasVariant(e)}getVariant(e){return this.referenceStyle.getVariant(e)}getVariants(){return this.referenceStyle.getVariants().filter(e=>e!==this)}getImageURL(){return this.imageURL}getExpandedStyleURL(){return Y(this.getId())}}class M{constructor(e,n){this.name=e,this.id=n,Z(this,"variants",{}),Z(this,"orderedVariants",[])}getName(){return this.name}getId(){return this.id}addVariant(e){this.variants[e.getType()]=e,this.orderedVariants.push(e)}hasVariant(e){return e in this.variants}getVariant(e){return e in this.variants?this.variants[e]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0]}}const w=[{referenceStyleID:"STREETS",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"streets-v2-night",name:"Night",variantType:"NIGHT",description:"",imageURL:""},{id:"streets-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]}];function Ee(t){return new Proxy(t,{get(e,n,i){return e.hasVariant(n)?e.getVariant(n):n.toString().toUpperCase()===n?t.getDefaultVariant():Reflect.get(e,n,i)}})}function Pe(){const t={};for(let e=0;e<w.length;e+=1){const n=w[e],i=Ee(new M(n.name,n.referenceStyleID));for(let r=0;r<n.variants.length;r+=1){const o=n.variants[r],a=new C(o.name,o.variantType,o.id,i,o.description,o.imageURL);i.addVariant(a)}t[n.referenceStyleID]=i}return t}function K(t){if(!t)return J[w[0].referenceStyleID].getDefaultVariant().getId();if(typeof t=="string"||t instanceof String)return t.trim().toLowerCase();if(t instanceof C)return t.getId();if(t instanceof M)return t.getDefaultVariant().getId()}const J=Pe();function ke(t,e,n){let i=e[0],r=e[1],o=n[0]-i,a=n[1]-r;if(o!==0||a!==0){const c=((t[0]-i)*o+(t[1]-r)*a)/(o*o+a*a);c>1?(i=n[0],r=n[1]):c>0&&(i+=o*c,r+=a*c)}return o=t[0]-i,a=t[1]-r,o*o+a*a}function O(t,e,n,i,r){let o=i,a;for(let c=e+1;c<n;c++){const s=ke(t[c],t[e],t[n]);s>o&&(a=c,o=s)}o>i&&(a-e>1&&O(t,e,a,i,r),r.push(t[a]),n-a>1&&O(t,a,n,i,r))}function we(t,e){const n=t.length-1,i=[t[0]];return O(t,0,n,e,i),i.push(t[n]),i}function be(t,e){if(t.length<=2)return t;const n=e!==void 0?e*e:1;return we(t,n)}function j(t,e=!0){let n=`${t[0]},${t[1]}`;return t.length===3&&e&&(n+=`,${t[2]}`),n}function H(t,e=3e3){let n=t.map(o=>o.join(",")).join("|"),i=5e-6;const r=1e-5;for(;n.length>e;)n=be(t,i).map(o=>`${o[0]},${o[1]}`).join("|"),i+=r;return n}function Ne(t,e,n={}){var i,r,o,a,c;const s=K(n.style),l=n.hiDPI?"@2x":"",d=(i=n.format)!=null?i:"png";let f=~~((r=n.width)!=null?r:1024),m=~~((o=n.height)!=null?o:1024);n.hiDPI&&(f=~~(f/2),m=~~(m/2));const p=new URL(`maps/${encodeURIComponent(s)}/static/${t[0]},${t[1]},${e}/${f}x${m}${l}.${d}`,y.maptilerApiURL);if("attribution"in n&&p.searchParams.set("attribution",n.attribution.toString()),"markers"in n){let h="";const g="markerIcon"in n;g&&(h+=`icon:${n.markerIcon}|`),g&&"markerAnchor"in n&&(h+=`anchor:${n.markerAnchor}|`),g&&n.hiDPI&&(h+="scale:2|");const L=Array.isArray(n.markers[0])?n.markers:[n.markers];h+=L.map(T=>j(T,!g)).join("|"),p.searchParams.set("markers",h)}if("path"in n){let h="";if(h+=`fill:${(a=n.pathFillColor)!=null?a:"none"}|`,"pathStrokeColor"in n&&(h+=`stroke:${n.pathStrokeColor}|`),"pathWidth"in n){const g=n.pathWidth/(n.hiDPI?2:1);h+=`width:${g.toString()}|`}h+=H(n.path),p.searchParams.set("path",h)}return p.searchParams.set("key",(c=n.apiKey)!=null?c:v.apiKey),p.toString()}function Ce(t,e={}){var n,i,r,o,a;const c=K(e.style),s=e.hiDPI?"@2x":"",l=(n=e.format)!=null?n:"png";let d=~~((i=e.width)!=null?i:1024),f=~~((r=e.height)!=null?r:1024);e.hiDPI&&(d=~~(d/2),f=~~(f/2));const m=new URL(`maps/${encodeURIComponent(c)}/static/${t[0]},${t[1]},${t[2]},${t[3]}/${d}x${f}${s}.${l}`,y.maptilerApiURL);if("attribution"in e&&m.searchParams.set("attribution",e.attribution.toString()),"padding"in e&&m.searchParams.set("padding",e.padding.toString()),"markers"in e){let p="";const h="markerIcon"in e;h&&(p+=`icon:${e.markerIcon}|`),h&&"markerAnchor"in e&&(p+=`anchor:${e.markerAnchor}|`),h&&e.hiDPI&&(p+="scale:2|");const g=Array.isArray(e.markers[0])?e.markers:[e.markers];p+=g.map(L=>j(L,!h)).join("|"),m.searchParams.set("markers",p)}if("path"in e){let p="";if(p+=`fill:${(o=e.pathFillColor)!=null?o:"none"}|`,"pathStrokeColor"in e&&(p+=`stroke:${e.pathStrokeColor}|`),"pathWidth"in e){const h=e.pathWidth/(e.hiDPI?2:1);p+=`width:${h.toString()}|`}p+=H(e.path),m.searchParams.set("path",p)}return m.searchParams.set("key",(a=e.apiKey)!=null?a:v.apiKey),m.toString()}function Me(t={}){var e,n,i,r,o;if(!("markers"in t)&&!("path"in t))throw new Error("Automatic static maps require markers and/or path to be created.");const a=K(t.style),c=t.hiDPI?"@2x":"",s=(e=t.format)!=null?e:"png";let l=~~((n=t.width)!=null?n:1024),d=~~((i=t.height)!=null?i:1024);t.hiDPI&&(l=~~(l/2),d=~~(d/2));const f=new URL(`maps/${encodeURIComponent(a)}/static/auto/${l}x${d}${c}.${s}`,y.maptilerApiURL);if("attribution"in t&&f.searchParams.set("attribution",t.attribution.toString()),"padding"in t&&f.searchParams.set("padding",t.padding.toString()),"markers"in t){let m="";const p="markerIcon"in t;p&&(m+=`icon:${t.markerIcon}|`),p&&"markerAnchor"in t&&(m+=`anchor:${t.markerAnchor}|`),p&&t.hiDPI&&(m+="scale:2|");const h=Array.isArray(t.markers[0])?t.markers:[t.markers];m+=h.map(g=>j(g,!p)).join("|"),f.searchParams.set("markers",m)}if("path"in t){let m="";if(m+=`fill:${(r=t.pathFillColor)!=null?r:"none"}|`,"pathStrokeColor"in t&&(m+=`stroke:${t.pathStrokeColor}|`),"pathWidth"in t){const p=t.pathWidth/(t.hiDPI?2:1);m+=`width:${p.toString()}|`}m+=H(t.path),f.searchParams.set("path",m)}return f.searchParams.set("key",(o=t.apiKey)!=null?o:v.apiKey),f.toString()}const Ke={centered:Ne,bounded:Ce,automatic:Me};function Oe(t){return t*Math.PI/180}function Q(t){return t%1!==0}var D={};function je(t,e){if(t<0||t>30)throw Error("Invalid zoom level");return Q(t)?X(t,e):(D[e]===void 0&&(D[e]={}),Array.isArray(D[e][t])||(D[e][t]=X(t,e)),D[e][t])}function X(t,e){let n=e*Math.pow(2,t);return[n/360,n/(2*Math.PI),n/2,n]}function ee(t,e,n=!1,i=512){let{min:r,max:o,sin:a,log:c,round:s}=Math,[l,d,f,m]=je(e,i),p=n?2:1,h=f,g=r(o(a(Oe(t[1])),-.9999),.9999),L=h+t[0]*l,T=h+.5*c((1+g)/(1-g))*-d;return Q(e)||(L=s(L),T=s(T)),L>m*p&&(L=m*p),T>m&&(T=m),[L,T]}function He(t,e=512){let{floor:n}=Math,i=n(t[0]/e),r=n(t[1]/e);return[i,r]}function Ve(t,e,n=512){let i=ee(t,e,!1,n);return He(i,n)}function Ge(t,e,n=512){let[i,r,o]=e,a=ee(t,i,!1,n),c=r*n,s=o*n;return[(a[0]-c)/n,(a[1]-s)/n]}var Fe=Math.pow;const b=63710088e-1;function R(t){return t*3.28084}function I(t){return t%360*Math.PI/180}function ze(t){return t*180/Math.PI}function te(t,e,n=512){return Math.cos(t*Math.PI/180)*2*Math.PI*6378137/(n*Fe(2,e))*3}function ne(t,e,n){return((1<<n)*e+t)*32+n}function xe(t){const e="geometry"in t?t.geometry:t;return e.type==="MultiPolygon"?ie(e.coordinates):V(e.coordinates)}function ie(t){const e="coordinates"in t?t.coordinates:t;let n=0;for(const i of e)n+=V(i);return n}function V(t){const e="coordinates"in t?t.coordinates:t;let n=0;for(const i of e)n+=Be(i);return n}function Be(t){let e,n,i,r,o,a,c,s=0;const l=t.length;if(l>2){for(c=0;c<l;c++)c===l-2?(r=l-2,o=l-1,a=0):c===l-1?(r=l-1,o=0,a=1):(r=c,o=c+1,a=c+2),e=t[r],n=t[o],i=t[a],s+=(I(i[0])-I(e[0]))*Math.sin(I(n[1]));s=s*b*b/2}return Math.abs(s)}function We(t){const e="geometry"in t?t.geometry.coordinates:"coordinates"in t?t.coordinates:t;let n=0,i;for(const r of e)i!==void 0&&(n+=N(i,r)),i=r;return n}function N(t,e){const{pow:n,sin:i,cos:r,sqrt:o,atan2:a}=Math,c=I(e[1]-t[1]),s=I(e[0]-t[0]),l=I(t[1]),d=I(e[1]),f=n(i(c/2),2)+n(i(s/2),2)*r(l)*r(d);return 2*a(o(f),o(1-f))*b}function _e(t,e,n){const i=new Map,r=[],o=[],a=te(t[0][1],e,n),c=qe(t,a);for(const s of c){const l=s,[d,f]=Ve(l,e,n),m=ne(d,f,e),p={id:m,x:d,y:f,z:e};i.set(m,p),o.push({coordinate:l,tile:p})}for(const s of i.values())r.push(s);return{coords:o,tiles:r}}function qe(t,e){const n=[];let i;for(const r of t){if(i!==void 0){const o=N(i,r),a=Math.ceil(o/e);for(let c=0;c<=a-1;c++){const s=[i[0]+(r[0]-i[0])*(c/a),i[1]+(r[1]-i[1])*(c/a)];n.push(s)}}else n.push(r);i=r}return n}function Ze(t,e,n,i,r=ae){const{channels:o,image:a}=i;let[c,s]=Ge(t,e,n);c=re(c,n),s=re(s,n);const l=(s*n+c)*o;return r(a[l],a[l+1],a[l+2],o===4?a[l+3]:0)}function re(t,e){return Math.max(0,Math.min(e,Math.floor(t*e)))}function ae(t,e,n){return-1e4+(t*256*256+e*256+n)*.1}var oe=(t,e,n)=>new Promise((i,r)=>{var o=s=>{try{c(n.next(s))}catch(l){r(l)}},a=s=>{try{c(n.throw(s))}catch(l){r(l)}},c=s=>s.done?i(s.value):Promise.resolve(s.value).then(o,a);c((n=n.apply(t,e)).next())});function Ye(t,e){return oe(this,null,function*(){var n,i,r;const o="geometry"in t?t.geometry.coordinates:t.coordinates,{coords:a,tiles:c}=_e(o,(n=e.zoom)!=null?n:13,(i=e.tileSize)!=null?i:512),s=yield Je(c,e.tileRequest);let l=Qe(a,s,(r=e.tileSize)!=null?r:512,e.elevationParser);e.smooth===!0&&(l=et(l));let d=Xe(l);return e.metric==="ft"&&(d=tt(d)),d})}function Je(t,e){return oe(this,null,function*(){const n=new Map,i=[];for(const r of t)i.push(e(r.x,r.y,r.z).then(o=>(n.set(r.id,o),o)).catch(o=>{console.error(o)}));return yield Promise.allSettled(i),n})}function Qe(t,e,n,i){const r=[];let o=0,a;for(const{tile:c,coordinate:s}of t){const l=e.get(c.id);if(l===void 0)throw new Error(`Missing tile ${c.id} (${c.x}-${c.y}-${c.z})`);const d=Ze(s,[c.z,c.x,c.y],n,l,i);r.push({distance:o,elevation:d,coordinate:s,tile:c}),a!==void 0&&(o+=N(a,s)),a=s}return r}function Xe(t){let e=1/0,n=-1/0,i=0;for(const r of t)r.elevation<e&&(e=r.elevation),r.elevation>n&&(n=r.elevation),i+=r.elevation;return{distance:t[t.length-1].distance,minElevation:e,maxElevation:n,avgElevation:i/t.length,startElevation:t[0].elevation,endElevation:t[t.length-1].elevation,points:t}}function et(t){const e=[];let n;for(const i of t){if(n===void 0)e.push(i);else{const r={distance:i.distance,elevation:(n.elevation+i.elevation)/2,coordinate:i.coordinate,tile:i.tile};e.push(r)}n=i}return e}function tt(t){return{distance:R(t.distance),minElevation:R(t.minElevation),maxElevation:R(t.maxElevation),avgElevation:R(t.avgElevation),startElevation:R(t.startElevation),endElevation:R(t.endElevation),points:t.points.map(({distance:e,elevation:n,coordinate:i,tile:r})=>({distance:R(e),elevation:R(n),coordinate:i,tile:r}))}}u.ClientConfig=F,u.LanguageGeocoding=$,u.MapStyle=J,u.MapStyleVariant=C,u.ReferenceMapStyle=M,u.ServiceError=A,u.area=xe,u.config=v,u.coordinates=Se,u.data=Ue,u.defaultElevationParser=ae,u.degToRad=I,u.earthRadius=b,u.expandMapStyle=Y,u.geocoding=ge,u.geolocation=Ae,u.getZoomLevelResolution=te,u.lineDistance=We,u.mToFt=R,u.mapStylePresetList=w,u.multiPolygonArea=ie,u.pointDistance=N,u.polygonArea=V,u.profileLineString=Ye,u.radToDeg=ze,u.staticMaps=Ke,u.xyzToTileID=ne,Object.defineProperty(u,"__esModule",{value:!0})});
